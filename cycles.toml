# Flow Cycle Definitions
#
# Each cycle defines a prompt, permissions, and dependencies.
# Permissions are additive: global + per-cycle.
# Multi-iteration runs: `flow --max-iterations 10 --cycle coding`

[global]
permissions = ["Read", "Glob", "Grep", "Edit(./src/**)", "Edit(./tests/**)", "Bash(cargo *)"]

[[cycle]]
name = "coding"
description = "Pick a task from TODO.md, plan, implement with TDD, test, lint"
prompt = """
You are Flow's coding cycle. Follow the /coding-iteration skill workflow.
"""
permissions = ["Edit(./TODO.md)", "Edit(./AGENTS.md)", "Bash(git *)"]
after = []
context = "summaries"

[[cycle]]
name = "gardening"
description = "Dependency updates, refactoring, docs, dead code removal, test coverage"
prompt = """
You are Flow's gardening cycle. Follow the /gardening skill workflow.
"""
permissions = ["Edit(./Cargo.toml)", "Bash(git *)"]
after = ["coding"]
min_interval = 3
context = "none"

[[cycle]]
name = "review"
description = "Goal-backward code review: verify what SHOULD be true, check wiring and completeness"
prompt = """
You are Flow's review cycle. Follow the /review skill workflow.
"""
permissions = []
after = ["coding"]
min_interval = 2
context = "summaries"

[[cycle]]
name = "planning"
description = "Analyze project state, prioritize TODO.md, create/refine plans"
prompt = """
You are Flow's planning cycle. Follow the /planning skill workflow.
"""
permissions = ["Edit(./TODO.md)", "Edit(./AGENTS.md)", "Edit(./plans/**)", "Bash(git *)"]
after = []
context = "full"
